<div class="container">
	<div class="header d-flex justify-content-between">
		<div class="d-flex justify-content-center">
			<img src="../../../assets/images/BigMint-Logo.webp" alt="BigMint Logo" class="bigmint-logo">
			<div class="grp-info">
				<h3 class="grp-name">
					BigMint
				</h3>
				<p class="grp-status">
					Feed Management Application
				</p>
			</div>
		</div>
		<div>
			<button mat-icon-button [matMenuTriggerFor]="filterMenu">
				<mat-icon>filter_alt</mat-icon>
			</button>
			<button mat-icon-button [matMenuTriggerFor]="additionalMenu">
				<mat-icon>more_vert</mat-icon>
			</button>
		</div>
	</div>
	<div class="chatbox" #chatbox>
		<div class="chat" *ngFor="let msg of messages">
			<div class="message-status" [ngClass]="{
					'published':msg.status == FeedStatus.PUBLISHED,
					'accepted':msg.status == FeedStatus.ACCEPTED,
					'submitted':msg.status == FeedStatus.SUBMITTED,
					'rejected':msg.status == FeedStatus.REJECTED,
					'verified':msg.status == FeedStatus.VERIFIED
				}">
				{{msg.status.slice(0,1)}}
			</div>
			<div class="msg" [ngClass]="{
				'high':msg.priority == FeedPriority.HIGH,
				'medium':msg.priority == FeedPriority.MEDIUM,
				'low':msg.priority == FeedPriority.LOW,
			}">
				<div class="icon-toolbar">
					<ng-icon (click)="bookmarkPost(msg)" name="heroStarSolid" size="20"
						[color]="msg.isBookmarked ? 'yellow' : 'grey' "></ng-icon>
					<button mat-icon-button class="hide" [matMenuTriggerFor]="feedMenu"
						#feedMenuTrigger="matMenuTrigger">
					</button>
					<ng-icon name="heroEllipsisVertical" size="20" color="grey"
						(click)="feedMenuTrigger.openMenu(); selectChatMessage(msg)"></ng-icon>
				</div>
				<p style="margin-top: 10px;" [innerHTML]="msg.messageContent"></p>
				<div style="text-align: center;">
					<img class="preview" *ngIf="msg.type == FeedType.IMAGE && msg.imageUrl" [src]="msg.imageUrl">
					<img class="preview" *ngIf="msg.type == FeedType.FILE && msg.fileThumbnailImageUrl"
						[src]="msg.fileThumbnailImageUrl">
				</div>
				<div class="text-center">
					<button (click)="openURLInNewTab(msg.articleUrl)" *ngIf="msg.type == FeedType.ARTICLE">View
						Article</button>
					<button (click)="openURLInNewTab(msg.fileUrl)" *ngIf="msg.type == FeedType.FILE">View File</button>
					<button (click)="openURLInNewTab(msg.imageUrl)" *ngIf="msg.type == FeedType.IMAGE">View
						Image</button>
				</div>
			</div>
			<div class="date-posted">Posted by <b>{{msg.postedBy}}</b> on
				{{globalService.convertSecondsToTimestamp(msg.postedOn)
				| date:'short'}}</div>
		</div>
	</div>

	<div class="policy slide-in-bottom" *ngIf="isSharePanelEnabled">
		<!-- <p>
			By using the chat, I confirm that I have read the
			<a href="#">privacy policy</a>
			and do not object to the use of my personal data.
		</p>
		<a href="#" class="agree">
			I agree
		</a> -->
		<div>
			<share-buttons [theme]="'circles-dark'"
				[include]="['facebook','twitter','linkedin','reddit','messenger','whatsapp','copy']" [show]="7"
				[showText]="true" [url]="shareableURL"></share-buttons>
		</div>
	</div>
</div>

<mat-menu #additionalMenu="matMenu">
	<button mat-menu-item>
		<span>Submit Feed</span>
	</button>
	<button mat-menu-item>
		<span>My Feeds</span>
	</button>
	<button mat-menu-item>
		<span>Score Card</span>
	</button>
	<button mat-menu-item>
		<span>Terms & Condition</span>
	</button>
	<button mat-menu-item>
		<span>My Trade</span>
	</button>
</mat-menu>

<mat-menu #filterMenu="matMenu">
	<button mat-menu-item style="padding-left: 5px;">
		<mat-form-field>
			<mat-label>Enter a date range</mat-label>
			<mat-date-range-input [formGroup]="range" [rangePicker]="picker">
				<input matStartDate formControlName="start" placeholder="Start date">
				<input matEndDate formControlName="end" placeholder="End date">
			</mat-date-range-input>
			<mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
			<mat-date-range-picker #picker></mat-date-range-picker>
			<mat-error *ngIf="range.controls.start.hasError('matStartDateInvalid')">Invalid start date</mat-error>
			<mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')">Invalid end date</mat-error>
		</mat-form-field>
	</button>
	<button mat-menu-item>
		<share-button [theme]="'circles-dark'" [button]="'facebook'" [url]="'https://twitter.com/'"
			[autoSetMeta]="false"></share-button>
	</button>
</mat-menu>

<mat-menu #categoryMenu="matMenu">
	<button mat-menu-item>
		<span>Submit Feed</span>
	</button>
	<button mat-menu-item>
		<span>My Feeds</span>
	</button>
	<button mat-menu-item>
		<span>Score Card</span>
	</button>
	<button mat-menu-item>
		<span>Terms & Condition</span>
	</button>
	<button mat-menu-item>
		<span>My Trade</span>
	</button>
</mat-menu>

<mat-menu #feedMenu="matMenu">
	<button mat-menu-item>
		<mat-icon>info</mat-icon>
		<span>More Information</span>
	</button>
	<button *ngIf="selectedChatMessage?.isShareable" mat-menu-item (click)="showShareOption()">
		<mat-icon>share</mat-icon>
		<span>Share this feed</span>
	</button>
</mat-menu>